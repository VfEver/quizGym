<?xml version="1.0" encoding="UTF-8" ?>
	<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.quizGym.entity.Question">
	<resultMap type="question" id="questionMap">
		<id property="id" column="question_id"/>
		<result property="name" column="question_name"/>
		<result property="answerA" column="answerA"/>
		<result property="answerB" column="answerB"/>
		<result property="answerC" column="answerC"/>
		<result property="answerD" column="answerD"/>
		<result property="rightAnswer" column="right_answer"/>
		<result property="reason" column="reason"/>
		<result property="typeID" column="type_id"/>
	</resultMap>
	
	<!-- 插入题目 -->
	<insert id="saveQuestion" parameterType="question">
		insert into question(question_name,answerA,answerB,answerC,answerD,right_answer,reason,qt_id)
		values(#{name},#{answerA},#{answerB},#{answerC},#{answerD},#{rightAnswer},#{reason},#{typeID})
	</insert>
	
	<!-- 随机查找一定数量的题目 -->
	<select id="randFindQuestion" parameterType="map" resultMap="questionMap">
		select q.question_id, q.question_name, q.answerA,q.answerB, q.answerC, q.answerD, q.right_answer, q.reason
		from question q inner join types t
		on q.qt_id = t.types_id
		and t.types_name = #{type}
		order by rand()
		limit 0,#{num}
	</select>
	
	<!-- 查询当前最大的id -->
	<select id="findMaxID" resultType="java.lang.Integer">
		select max(question_id) from Question
	</select>
	
	<!-- 根据一些列id查询题目 -->
	<select id="findSpec" resultMap="questionMap">
		select *
		from question
		where question_id in 
		<foreach collection="list" item="question_id" index="index" open="(" close=")" separator=",">
			#{question_id}
		</foreach>
	</select>
	
	<!-- 查询所有题目 -->
	<select id="findAllQuestion" resultMap="questionMap">
		select *
		from question
	</select>
	
	<!-- 查询题目类型 -->
	<select id="findRandQuestionType" parameterType="int" resultType="int">
		select q.qt_id
		from question as q right join 
		(select u.question_id, u.random_id = #{id}
		from uq_random_middle u inner join ur_middle r
		on u.random_id = r.random_id) as m
		on q.question_id = m.question_id
		limit 0,1
	</select>
</mapper>